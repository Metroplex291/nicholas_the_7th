{% extends "base/base.html" %}

{% set title = title %}

{% block head %}{{super()}}
  <script>
  window.scrollTo({top: document.body.scrollHeight, behavior: 'instant'});
  function onLoad() {
      let elements = document.getElementsByClassName("hidden_on_load");
      for (let i = 0; i < elements.length; i++) {
          elements[i].style.display = "block";
      }
  }
  window.addEventListener("load", onLoad);
  </script>
  <script defer src="https://unpkg.com/htmx.org@1.9.6"></script>
{% endblock %}

{% block content %}
  {% if errors %}
    {% for error in errors %}
      <div class="alert alert-danger div-align alert-dismissible fade show sticky-top" role="alert">
        {{ error }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    {% endfor %}
  {% endif %}
  {% if messages %}
    {% for message in messages %}
      <div class="alert alert-success div-align alert-dismissible fade show sticky-top" role="alert">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    {% endfor %}
  {% endif %}

  <a href="/admin" class="btn btn-primary">Return to Admin Panel</a>

  <div class="div-log">
    {% if lines %}
      <div class="div-log">
        {% for line in lines[:100] %}
          <p>{{ line }}</p>
        {% endfor %}
      </div>
    {% endif %}
    {% if chunks %}
      {% for i in range(1, chunks-1) %}
        <div hx-get="/admin/inflog?type={{log_type}}&index={{i}}" hx-target="this" hx-trigger="intersect once"
             hx-swap="outerHTML" style="display: none" class="hidden_on_load" hx-indicator="#spinner{{i}}">
          <div style="height: 150rem"></div>
          <div class="text-center">
            <div class="spinner-border text-primary htmx-indicator" role="status" id="spinner{{i}}" style="width: 3rem; height: 3rem;"></div>
          </div>
        </div>
      {% endfor %}
    {% endif %}
  </div>

{#  <div class="div-log">#}
{#    {% for line in log_data %}#}
{#    <p>{{ line }}</p>#}
{#    {% endfor %}#}
{#  </div>#}
{% endblock %}